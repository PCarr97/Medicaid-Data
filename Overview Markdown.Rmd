---
title: "Medicaid Data Exploration"
author: "Patrick Carr"
date: "02-07-2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data Exploration
This exploration will look at the impact of the increase in Medicaid eligibility as a percentage of the federal poverty line.

I will be exploring trends in five separate data sets. First, I will look at the number of emergency room visits per thousand Americans, pear year:

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include = FALSE}
install.packages('pacman', repos = "http://cran.us.r-project.org")
library(pacman)
p_load(tidyverse, janitor, lubridate, dplyr, ggplot, tinytex)

# Import and format data on Medicaid eligibility cutoffs
eligibility <- read_csv("Raw Data/eligibility.csv", 
                        col_names = c("Year", "Percent"), skip = 2)
eligibility$Year <- as.Date(as.character(eligibility$Year), format = "%Y")



# Import and format data on Americans foregoing medical care due to cost
forego <- read_csv("Raw Data/foregoing-care.csv", 
                   col_names = c("Abv", "Location", "Year", "Format", "Percent", "MOE"), skip = 6)
forego <- subset(forego, select = c("Year", "Percent"))
forego$Year <- as.Date(as.character(forego$Year), format = "%Y")



# Import and format data on ER visits per 1000 Americans
ervisits <- read_csv("Raw Data/er-visits.csv", 
                     col_names = c("Year", "Visits"), skip = 2)
ervisits$Year <- as.Date(as.character(ervisits$Year), format = "%Y")



# Import and format data on assets, in thousands, of lowest 20% of American earners
finances <- read_csv("Raw Data/finances.csv", 
                     col_names = c("Year", "Status", "Income", "Assets", "Debt"), skip = 5)
finances <- subset(finances, select = c("Year", "Assets", "Debt"))
finances$Year <- as.Date(as.character(finances$Year), format = "%Y")



# Import, truncate, and format data on health status survey data (lower value = better health)
hstatus <- read_csv("Raw Data/health-status.csv",
                    col_names = c("Year", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", 
                                  "2013", "2014", "2015", "2016", "2017", "2018", "2019"), skip = 5)
hstatus <- as.data.frame(t(hstatus[1:22, 1:15]))
hstatus <- hstatus |>  row_to_names(row_number = 1)
hstatus <- cbind(Year = rownames(hstatus), hstatus)
rownames(hstatus) <- 1:nrow(hstatus)
hstatus$Year <- as.Date(as.character(hstatus$Year), format = "%Y")
hstatus[,2:22] = apply(hstatus[,2:22], 2, function(x) as.numeric(as.character(x)))
colnames(hstatus) <- c("Year", "All_Ages_adj", "All_Ages_crude", "Under18", "Under6", "6to17", "18to44",
                       "18to24", "25to44", "45to54", "55to64", "Over65", "65to74", "Over75", "Male", 
                       "Female", "White", "Black", "Hispanic", "Under100pct", "100to199pct", "200to399pct", 
                       "Over400pct")
```

Below are the summary statistics for emergency room visits.
```{r, echo = FALSE, message = FALSE, warning = FALSE}
ervisits <- read_csv("Raw Data/er-visits.csv", 
                     col_names = c("Year", "Visits"), skip = 2)
ervisits$Year <- as.Date(as.character(ervisits$Year), format = "%Y")
summary(ervisits$Visits)
```
## Data Trends

This trend shows the average percentage of the poverty line to qualify for Medicaid coverage. In 2013, the data leaps up to 138% due to the implementation of the Affordable Care Act.

```{r pressure, echo=FALSE}
eligibility |> 
  ggplot() +
  geom_point(aes(x = Year, y = Percent), size = 2.5, color = "#1d65a0") +
  ylim(0, 1.4) +
  xlab("Year") + 
  ylab("Eligibility as % of Poverty Line") +
  ggtitle("Medicaid Eligibility Trend") +
  theme(panel.background = element_rect(fill = '#fcf9f7', color = 'black'),
        panel.grid.major = element_line(color = '#818a92', linetype = 'dotted'),
        panel.grid.minor = element_line(color = '#818a92', linetype = 'dotted'),
        axis.text.x = element_text(color = 'black', size = 11),
        axis.text.y = element_text(color = 'black', size = 11),
        axis.title.x = element_text(color = 'black', size = 12.5),
        axis.title.y = element_text(color = 'black', size = 12.5),
        plot.title = element_text(size = 14, face = "bold"))
```

